<% content_for :header do %>
<h2 class="pull-left"><i class="fa fa-tasks"></i> Tasks</h2>

    <!-- Breadcrumb -->
    <div class="bread-crumb pull-right">
      <%= link_to "Dashboard", root_path, class: "bread-crumb" %>
      <span class="divider">/</span> 
      <%= link_to "Tasks", tasks_path, class: "bread-current" %>
    </div>
<% end %>

<% content_for :stats do %>

<div class="matter">

<% end %>

    <div class="container">
        <div class="row">
            <div class="col-md-12 text-right">
                <%= link_to 'Add New Task', new_task_path, :class => "btn btn-primary" %>
                <div class="clear"></div>
            </div>
        </div>

        <div class="row">

            <div class="col-md-8">
                <!-- incomplete tasks begin -->
                <%= render  :layout => 'shared/widget', :locals => { :title => @widget_title } do %>
                    <% if @tasks.present? %>
                        <table class="table table-hover" id="tasks">
                            <thead>
                                <th colspan="2">
                                    Sort By<span class="sort-spacer"></span> 
                                    <%= sortable "due_date", "Due Date (mm/dd/yyyy)" %>
                                    <span class="sort-spacer">|</span> 
                                    <%= sortable "category" %>
                                </th>
                                <th></th>
                            </thead>
                            <tbody>
                                <%= render :partial => 'tasks/task', :collection => @tasks, :locals => {:hide_contact => false} %>
                            </tbody>
                        </table>
                    <% else %>
                        <div class="padd">
                            <p>No tasks available.</p>
                        </div>
                    <% end %>
                    <div class="widget-foot text-right">
                        <%= link_to "Add New Task", new_task_path, :class => "btn btn-primary" %>
                        <div class="clear"></div>
                    </div>
                <% end %>
                <!-- incomplete tasks end -->
            </div>

            <div class="col-md-4">

                <%= render  :layout => 'shared/widget', :locals => { title: 'Filter Tasks' } do %>
                    <div class="padd text-center">
                        <div class="btn-group">
                            <%= link_to "Incomplete", tasks_path(filter_type: 'incomplete'), class: 'btn btn-default', id: 'incomplete-button', type: 'button' %>
                            <%= link_to "Overdue", tasks_path(filter_type: 'overdue'), class: 'btn btn-default', id: 'overdue-button', type: 'button' %>
                            <%= link_to "Completed", tasks_path(filter_type: 'completed'), class: 'btn btn-default', id: 'completed-button', type: 'button' %>
                        </div>
                    </div>
                    <div class="widget-foot text-right">
                        <%= link_to "Clear", tasks_path, class: 'btn btn-info' %>
                    </div>
                <% end %>

                <%= render  :layout => 'shared/widget', :locals => { title: 'Stats' } do %>
                    <div class="padd text-center">
                        <div id="tasks-summary-wiget" class="widget-chart"></div>
                    </div>
                    <div class="widget-foot text-right tasks-total-widget">
                    </div>
                <% end %>

            </div>
            <div class="clear"></div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <%= paginate @tasks, :theme => 'twitter-bootstrap' %>
            </div>
        </div>
    </div>

</div><!-- matter -->
<% content_for :additional_js do %>
    <script type="text/javascript">
        $(document).ready(function() {
            <% unless params[:filter_type].blank? %>
                <% if params[:filter_type] == 'incomplete' %>
                    $('a#incomplete-button').addClass('btn-primary');
                <% elsif params[:filter_type] == 'overdue' %>
                    $('a#overdue-button').addClass('btn-primary');
                 <% elsif params[:filter_type] == 'completed' %>
                    $('a#completed-button').addClass('btn-primary');
                <% end %>
            <% end %>
            tasksSummaryWidget(<%=raw widget_tasks_summary_data %>);
        });
    </script>
<% end %>
